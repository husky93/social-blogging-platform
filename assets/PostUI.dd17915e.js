import{I as A}from"./Icon.9d53e7af.js";import{h as l,j as t,u as P,a as E,e as b,P as L,p as z,w as j,E as M,G as N,I as R}from"./index.347ffc4f.js";import{showAlert as V}from"./Alert.52010a90.js";import{H as X,a as D}from"./HeartOutline.f0733d3a.js";const G=l.exports.forwardRef(function(c,a){return t("svg",{...Object.assign({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},c,{ref:a}),children:t("path",{d:"M400 480a16 16 0 0 1-10.63-4L256 357.41L122.63 476A16 16 0 0 1 96 464V96a64.07 64.07 0 0 1 64-64h192a64.07 64.07 0 0 1 64 64v368a16 16 0 0 1-16 16z",fill:"currentColor"})})}),U=l.exports.forwardRef(function(c,a){return t("svg",{...Object.assign({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},c,{ref:a}),children:t("path",{d:"M352 48H160a48 48 0 0 0-48 48v368l144-128l144 128V96a48 48 0 0 0-48-48z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"})})}),W=({likes:f=[],bookmarks:c=[],postID:a})=>{const[g,C]=l.exports.useState(!1),[h,B]=l.exports.useState(!1),[p,O]=l.exports.useState(f.length),[S,H]=l.exports.useState(c.length),s=P(e=>e.user),w=E();l.exports.useEffect(()=>{if(s.data!==null){const e=s.data.uid,r=f.find(n=>n===e),o=c.find(n=>n===e);r!==void 0&&C(!0),o!==void 0&&B(!0)}},[s]);const v=async(e,r,o,n,i,u,m)=>{if(i&&o){const x=L(z,n,i);if(!e){const d=u?{likesCount:p+1}:{};await j(x,{[r]:M(o),...d}),s.data&&!m&&w(N({postID:a,userID:s.data.uid,isBookmark:!u}))}if(e){const d=u?{likesCount:p-1}:{};await j(x,{[r]:R(o),...d}),s.data&&!m&&w(N({postID:a,userID:s.data.uid,isBookmark:!u}))}}},I=async(e,r,o,n,i)=>{v(e,r,o,n,i,!1,!0),v(e,r,i,"posts",o)},y=(e,r,o,n,i,u,m,x,d)=>{if(s.data===null){V("Error!","You must be logged in to like / bookmark your favorite posts!","warning",w);return}r(e?k=>k-1:k=>k+1),o(k=>!k),n(e,x,i,u,m,d)};return a===void 0?t("div",{}):b("div",{className:"hidden min-w-16 py-4 pr-6 sm:flex sm:flex-col sm:gap-8 text-2xl",children:[b("div",{className:"flex flex-col justify-center items-center",children:[t("button",{className:g?"flex items-center transition-all p-1 text-green-500 rounded cursor-pointer hover:text-green-800 hover:bg-gray-100":"flex items-center transition-all p-1 text-gray-500 rounded cursor-pointer hover:text-gray-900 hover:bg-gray-100",onClick:()=>{var e;y(g,O,C,v,(e=s.data)==null?void 0:e.uid,"posts",a,"likes",!0)},children:t(A,{children:g?t(X,{}):t(D,{})})}),t("span",{className:"text-gray-500 text-sm",children:p})]}),b("div",{className:"flex flex-col justify-center items-center",children:[t("button",{className:h?"flex items-center transition-all p-1 text-green-500 rounded cursor-pointer hover:text-green-800 hover:bg-gray-100":"flex items-center transition-all p-1 text-gray-500 rounded cursor-pointer hover:text-gray-900 hover:bg-gray-100",onClick:()=>{var e;y(h,H,B,I,a,"users",(e=s.data)==null?void 0:e.uid,"bookmarks")},children:t(A,{children:h?t(G,{}):t(U,{})})}),t("span",{className:"text-gray-500 text-sm",children:S})]})]})};export{W as default};
